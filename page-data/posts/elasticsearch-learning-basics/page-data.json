{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/elasticsearch-learning-basics/","webpackCompilationHash":"55513de83e71e41db443","result":{"data":{"site":{"siteMetadata":{"author":{"name":"Joey Xie","contacts":{"twitter":"xf_joey"}},"disqusShortname":"joeyxf-com","subtitle":"每天进步一点点","title":"Joey的博客","url":"https://joeyxf.com"}},"markdownRemark":{"id":"0ca0bb1f-3fc5-53b8-a75d-7fa62cc342b1","html":"<h2 id=\"简介\"><a href=\"#%E7%AE%80%E4%BB%8B\" aria-label=\"简介 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>简介</h2>\n<p>Elasticsearch是一个高可用的，开源的，支持海量数据读写，搜索和分析的引擎。常见的用途有搜索、日志存储与检索。<a href=\"https://www.elastic.co/guide/cn/elasticsearch/guide/current/foreword_id.html\">中文文档</a>是个开始的好地方</p>\n<h2 id=\"搭建部署服务器\"><a href=\"#%E6%90%AD%E5%BB%BA%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E5%99%A8\" aria-label=\"搭建部署服务器 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搭建部署服务器</h2>\n<p>官网上说服务器至少要安装jdk8，但是我自己电脑上使用的是<code class=\"language-text\">OpenJDK 9</code>也能部署，所以应该8以上都能跑。\n按照官方文档，ubuntu服务器的安装流程如下：</p>\n<ol>\n<li>\n<p>导入签名</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">wget</span> -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> apt-key <span class=\"token function\">add</span> -</code></pre></div>\n</li>\n<li>\n<p>更新本地软件源</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token keyword\">echo</span> <span class=\"token string\">\"deb https://artifacts.elastic.co/packages/5.x/apt stable main\"</span> <span class=\"token operator\">|</span> <span class=\"token function\">sudo</span> <span class=\"token function\">tee</span> -a /etc/apt/sources.list.d/elastic-5.x.list</code></pre></div>\n</li>\n<li>\n<p>安装并且更新</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> elasticsearch</code></pre></div>\n</li>\n<li>\n<p>启动服务</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl start elasticsearch</code></pre></div>\n<p>在ubuntu 16.04机器上，es配置文件存放在<code class=\"language-text\">/etc/elasticsearch</code>目录下，可执行文件和插件等在<code class=\"language-text\">/usr/share/elasticsearch/</code>下，默认情况下es监听的是<code class=\"language-text\">localhost:9200</code>端口</p>\n</li>\n</ol>\n<h2 id=\"基本术语\"><a href=\"#%E5%9F%BA%E6%9C%AC%E6%9C%AF%E8%AF%AD\" aria-label=\"基本术语 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>基本术语</h2>\n<p><strong>集群(cluster):</strong>\n多个es节点，配置了相同的集群名字组成一个集群，集群内可以新增和删除节点</p>\n<p><strong>节点(node):</strong>\n一个运行中的es实例称为一个节点，一般是一台服务器</p>\n<p><strong>分片(shard):</strong>\n整个集群中的一部分数据</p>\n<p><strong>索引(index):</strong>\n索引实际上是指向一个或者多个物理 分片 的 逻辑命名空间，与mysql类比的话可以当作是数据库</p>\n<p><strong>类型(type):</strong>\n索引中相关的数据放在一个type中，类似mysql中的表</p>\n<p><strong>文档:</strong>\ntype中的一行记录</p>\n<h2 id=\"相关开发工具\"><a href=\"#%E7%9B%B8%E5%85%B3%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7\" aria-label=\"相关开发工具 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>相关开发工具</h2>\n<h3 id=\"curl\"><a href=\"#curl\" aria-label=\"curl permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>curl</h3>\n<p>使用curl来操作es，或者是其他http客户端</p>\n<h3 id=\"elasticdump\"><a href=\"#elasticdump\" aria-label=\"elasticdump permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>elasticdump</h3>\n<p>这个工具用来导出数据很方便，比如说把数据从一个索引导到另一个索引</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">elasticdump --input<span class=\"token operator\">=</span>http://localhost:9200/jtcsm --output<span class=\"token operator\">=</span>http://localhost:9200/jtcsm_nlp --type<span class=\"token operator\">=</span>data</code></pre></div>\n<h3 id=\"insomnia\"><a href=\"#insomnia\" aria-label=\"insomnia permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>insomnia</h3>\n<p>使用<a href=\"https://insomnia.rest/\">insomnia</a>来管理restapi\nelasticsearch的所有操作都是基于http api的，使用这个工具可以很方便的管理各种操作的api，比如说新建一个请求用来保存创建index的命令，新建一个请求用来保存创建mapping的命令，得益与insomnia强大的请求分类管理及导出功能，不用一行一行手动敲curl命令，或者是从记事本里复制出curl命令</p>\n<h2 id=\"查询语句\"><a href=\"#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5\" aria-label=\"查询语句 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查询语句</h2>\n<p>查询语句比较复杂，慢慢看文档去吧</p>\n<h2 id=\"中文分词\"><a href=\"#%E4%B8%AD%E6%96%87%E5%88%86%E8%AF%8D\" aria-label=\"中文分词 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>中文分词</h2>\n<p>中文搜索比较麻烦，同义词，近义词，多义词，多音词等等都是要考虑的问题，目前比较有名的分词插件有<a href=\"#\">ik</a>, <a href=\"#\">ansj</a>\n看star的话ik这个分词器比较流行，所以打算使用它，人多容易找到问题。ik默认是不支持多义词的，所以需要自定义分词器，把es内置的同义词典功能集成进来，目前同义词典尚不支持热更新，上网搜到了一些热更新的教程但是感觉用处不大，还不如本地词典，更新之后重启服务。</p>\n<h2 id=\"搜索优化\"><a href=\"#%E6%90%9C%E7%B4%A2%E4%BC%98%E5%8C%96\" aria-label=\"搜索优化 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>搜索优化</h2>\n<p>目前没有太好的办法，我是添加词库操作的</p>\n<h2 id=\"实际例子\"><a href=\"#%E5%AE%9E%E9%99%85%E4%BE%8B%E5%AD%90\" aria-label=\"实际例子 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>实际例子</h2>\n<p>基于大众点评数据做的搜索引擎</p>","fields":{"slug":"/posts/elasticsearch-learning-basics/","tagSlugs":["/tag/elasticsearch/","/tag/programming/","/tag/web-development/"]},"frontmatter":{"date":"2017-11-11 01:00:00","description":"如何搭建部署es服务，使用es进行基本的查询操作，一些简单的例子","tags":["Elasticsearch","Programming","Web Development"],"title":"elasticsearch基础查询功能"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/elasticsearch-learning-basics/"}}}