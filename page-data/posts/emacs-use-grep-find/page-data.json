{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/emacs-use-grep-find/","webpackCompilationHash":"42f3b01b292ae3aa1064","result":{"data":{"site":{"siteMetadata":{"author":{"name":"Joey Xie","contacts":{"twitter":"xf_joey"}},"disqusShortname":"joeyxf-com","subtitle":"每天进步一点点","title":"Joey的博客","url":"https://joeyxf.com"}},"markdownRemark":{"id":"3a917f4f-a8f1-5643-ab36-4c964be69b8b","html":"<p>被emacs的搜索功能纠结好久了，今天下定决心来解决一下。以前执行<code class=\"language-text\">grep-find</code>命令的时候查找的模板都是<code class=\"language-text\">find . -type f -exec grep -nH -e {} +</code>，但是这条命令在fish下没法用，找了一下发现在<a href=\"https://github.com/fish-shell/fish-shell/issues/95\">这个issue</a>里面作者提到了为什么fish里面没法用find，因为在fish里面<code class=\"language-text\">{}</code>是有意义的，所以就会提示exec缺少参数，所以如果写成<code class=\"language-text\">find . -type f -exec grep -nH -e &#39;{}&#39; +</code>就可以了，接下来的任务就是修改emacs的配置，把默认的<code class=\"language-text\">grep-find</code>的行为改掉。</p>\n<p>因为查找功能是emacs默认就有的，所以我直接就去源代码目录找了，在<code class=\"language-text\">/usr/share/emacs/24.4/</code>下执行<code class=\"language-text\">grep &#39;grep-find&#39; -R *</code>，然后在<code class=\"language-text\">lisp/ldefs-boot.el</code>和<code class=\"language-text\">lisp/loaddefs.el</code>找到了相关的代码，然后试着修改第12669行，这行看起来像是相关的代码，结果改完了半天不生效，无奈之下去<a href=\"http://stackoverflow.com/questions/28915372/change-the-default-find-grep-command-in-emacs/\">stackoverflow</a>提问，这个网站效率真的不是一般的高，很快就拿到答案了，有人说我找到的代码只不过是docstring而已，要修改的话得改<code class=\"language-text\">grep-find-template</code>,通过<code class=\"language-text\">C-h v</code>查看了一下这个变量的值，默认的是<code class=\"language-text\">&quot;find . &lt;X&gt; -type f &lt;F&gt; -exec grep &lt;C&gt; -nH -e &lt;R&gt; {} +&quot;</code>，修改它就行了，编辑<code class=\"language-text\">~/.emacs.d/personal/custom.el</code>，在最底下加上<code class=\"language-text\">(setq grep-find-template &quot;find . &lt;X&gt; -type f &lt;F&gt; -exec grep &lt;C&gt; -nH -e &lt;R&gt; \\&#39;{}\\&#39; +&quot;)</code>，然后<code class=\"language-text\">eval-buffer</code>，问题完美解决，不得不说emacs真是灵活，不用改源代码就能实现自定义功能。</p>\n<p>后面又修改了<code class=\"language-text\">find-grep-dired</code>的模板，好像这条命令没有模板，所以我直接改的代码，<code class=\"language-text\">/usr/share/emacs/24.4/lisp/find-dired.el.gz</code>编辑第278行，把{}转义了。</p>","fields":{"slug":"/posts/emacs-use-grep-find/","tagSlugs":["/tag/emacs/"]},"frontmatter":{"date":"2015-03-07","description":"被emacs的搜索功能纠结好久了，今天下定决心来解决一下。以前执行...","tags":["Emacs"],"title":"emacs使用自定义grep-find模板"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/emacs-use-grep-find/"}}}