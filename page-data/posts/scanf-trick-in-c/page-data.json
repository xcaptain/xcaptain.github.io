{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/scanf-trick-in-c/","webpackCompilationHash":"539c93736a11b6b79b58","result":{"data":{"site":{"siteMetadata":{"author":{"name":"Joey Xie","contacts":{"twitter":"xf_joey"}},"disqusShortname":"joeyxf-com","subtitle":"每天进步一点点","title":"Joey的博客","url":"https://joeyxf.com"}},"markdownRemark":{"id":"03cb795e-6a18-556b-9a43-2491e3e497f1","html":"<p>原文链接见：<a href=\"http://blog.csdn.net/zazzle/article/details/9226767\">http://blog.csdn.net/zazzle/article/details/9226767</a></p>\n<p>今天在写一个排序的小程序的时候偶然发现scanf使用的一个小小的陷阱，如果没有见过的话很难发现的。\n比如说scanf(“%d”, &#x26;A) 和 scanf(“%d ”, &#x26;A)这2个语句有区别吗？不仔细看是看不出区别的，前者%d后面紧跟这的是引号，后者%d后面加了一个空格然后再是引号。</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/* test1.c */</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> N 5</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> A<span class=\"token punctuation\">[</span>N<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> N<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> N<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d \"</span><span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a4e258d7b6e08e83a788ce74f79d173f/e8ce4/20130702173950171-scanf-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 271px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 35.79335793357934%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABQ0lEQVQY0z3O60rkMBTA8Xk6RQVFZqaX3HNykqZt0vTiTN0VdJRlYfEx9kVNQYQ/4Xz55ZzdWz+N9yUqXw5P2ngaXbUAmYzCRmuvwSvbiM7y3hGtiUIhHdcNZcAF7tbzbHmlWluOkQxWecc7SyPmj7Lc0h62WkqBMRDS5gjVGx4uz4dkaLIsAo9481HXEZF33/KnfBQDyr9xVcsNzy8raZTMh3VWNvbqz7FKGqUHcKCdhgZUC9Kj6HhlspcCczVRG35aX5nuFSaAXkNEPmkTFQaFg7ApD7y3LFiy4GEQVBqGPVGuLHnev0vnvwf96+hfC7fuw+n2+aUya41z4X7v/aW052Lm92/05rO8/tgfDTyE5S6komCUm93nsr4XZAyjOV/Ev/bxv5jcKaQpxmmI+Z1jWHKpO7U2eT+Ebmz9YF1ou/ELnRWlz+OWiNgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"./20130702173950171-scanf-1.png\"\n        title=\"\"\n        src=\"/static/a4e258d7b6e08e83a788ce74f79d173f/e8ce4/20130702173950171-scanf-1.png\"\n        srcset=\"/static/a4e258d7b6e08e83a788ce74f79d173f/0783d/20130702173950171-scanf-1.png 240w,\n/static/a4e258d7b6e08e83a788ce74f79d173f/e8ce4/20130702173950171-scanf-1.png 271w\"\n        sizes=\"(max-width: 271px) 100vw, 271px\"\n      />\n  </span>\n  </a></p>\n<p>这个程序的目的是从屏幕输入5个数字，并打印出来，这个程序运行的结果很正常，但是如果换第二种情况</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token comment\">/* test2.c */</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> N 5</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">int</span> A<span class=\"token punctuation\">[</span>N<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> N<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">scanf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d \"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> N<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d \"</span><span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/48d9ce93f122f969b8ae38eae8ad638d/3e8ea/20130702174050671-scanf-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 265px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 41.88679245283019%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABOElEQVQY03WRTU8CMRCG95d540T8IrJL2207/dppi4TFSEDZRVRCPOjR/2tZdUNMTN7DHOaZZzKTrdqV1FQEN17ESW1KtMK7cuakQQCUUPUpuSEUhHQpXBjKVLZsW4JmBNUFU2PBCiomBZBcMqZAe3WSxPdwGkSZzpbbRnAHMggeFHgjghIoVQUK1f8w5515cXhg1qjKS0Sw/uYeilobGf6Qyvg0kbBTc1p7tymi4tOKzo2M1eCQn7fM8SmYZP6VK69VAIGU9LA+wut1K4TRJmgISgV97A4dFsF0sV46lBUytBOe4Er25rvt+2XYT+ILwTXxj3nYE2y6usnjLvevtDajJzH8oIPP8XVNcz8frppcI6OQvcX589kglu5quZH2lvvIZihtSLYf+bcZURiXzDz9THsmbDreF6eTuj+C8QBMAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"./20130702174050671-scanf-2.png\"\n        title=\"\"\n        src=\"/static/48d9ce93f122f969b8ae38eae8ad638d/3e8ea/20130702174050671-scanf-2.png\"\n        srcset=\"/static/48d9ce93f122f969b8ae38eae8ad638d/0783d/20130702174050671-scanf-2.png 240w,\n/static/48d9ce93f122f969b8ae38eae8ad638d/3e8ea/20130702174050671-scanf-2.png 265w\"\n        sizes=\"(max-width: 265px) 100vw, 265px\"\n      />\n  </span>\n  </a></p>\n<p>就是多了一个空格但是却要输入6个数字才能打印前5个数字出来，真是奇怪啊。\n上网搜了一下发现<a href=\"https://stackoverflow.com/questions/12704907/explain-what-is-difference-between-without-whitespace-in-scanf-and-with-whitespa\">https://stackoverflow.com/questions/12704907/explain-what-is-difference-between-without-whitespace-in-scanf-and-with-whitespa</a> 有人问同样的问题，\n里面的答案说是scanf函数中前面用引号引起来的字符串是匹配字符串，里面一个空格可以匹配多个空格，tab, 回车，所以在第二种情况下输完5的时候输入回车想结束对整个数组的输入，但是C编译器却觉得你的输入还没有结束，所以会继续等待输入，这时候如果加入一个Ctrl-D就行了，在linux中这个是文件终止符。\n看到这里发现输入和输出里面也有这么多技巧，我们从屏幕输入时编译器会把输入的一切东西当作一个字符串存起来，然后和匹配字符串匹配，匹配完了的才能保存到变量中，\n这里面的匹配算法可以深入研究一下。</p>","fields":{"slug":"/posts/scanf-trick-in-c/","tagSlugs":["/tag/programming/"]},"frontmatter":{"date":"2013-07-02","description":"今天在写一个排序的小程序的时候偶然发现scanf使用的一个小小的陷阱...","tags":["Programming"],"title":"CSDN老博文迁移-scanf使用的一个小陷阱"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/scanf-trick-in-c/"}}}